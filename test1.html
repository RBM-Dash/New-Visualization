<!DOCTYPE html>

<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>GAPS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- including ECharts file -->
    <script src="js/echarts_en_4.9.min.js"></script>
    <script src="js/lodash.js"></script>
    <script src="js/chroma.js"></script>
    <script src="data/world.min.js"></script>


   
</head>

  <body>
        <title>GAPS</title>
        <div id="main" style="position:relative; width: 100%;height: 90vh; " class="gantt "></div>
    </body>
    <script>
        function nFormatter(num, digits) {
            // Convert numbers into a million (M), thousands (K), representation
            // Fails if one pass arg as string, if cleansed with parseFloat works well
            // One might use Math.abs(num) as well
            const lookup = [{
                value: 1,
                symbol: ""
            }, {
                value: 1e3,
                symbol: "k"
            }, {
                value: 1e6,
                symbol: "M"
            }, {
                value: 1e9,
                symbol: "G"
            }, {
                value: 1e12,
                symbol: "T"
            }, {
                value: 1e15,
                symbol: "P"
            }, {
                value: 1e18,
                symbol: "E"
            }];
            const rx = /\.0+$|(\.[0-9]*[1-9])0+$/;
            var item = lookup.slice().reverse().find(function(item) {
                return num >= item.value;
            });
            return item ? (num / item.value).toFixed(digits).replace(rx, "$1") + item.symbol : "0";
        }
        const myRedScale = ['#ffffe0', '#ffe9b7', '#ffd196', '#ffb67f', '#ff9b6f', '#f98065', '#ee665d', '#e14d54', '#cf3548', '#bb1e37', '#a40921', '#8b0000', '#580000', '#2D0000'];

        function createDiscretePieces(valis, colorMap) {
            // Create the pieces for the visualMap from Chroma deciles and minima and maxima of the data
            //console.log(_.values(valis))
            const allVal = _.values(valis);
            var myranget = chroma.limits(allVal, 'q', 10);
            var NN = _.compact(myranget).filter(function(x) {
                return x >= 0
            });
            var myrange = chroma.limits(NN, 'l', 13);
            let temp = {};
            var myPieces = [{
                value: -9999999999999,
                label: 'Not Applicable',
                color: '#aaa1a1'
            }];
            for (let i = 0; i < myPieces.length; i++) {
                temp.min = Math.round(myrange[i]);
                temp.mmax = Math.round(myrange[i] + 1);
                temp.color = colorMap[i];
                myPieces.push(temp);
            }
            myPieces.push({
                value: 9999999999,
                label: 'Not Applicable',
                color: '#e8eaed'
            });
            return myPieces;
        }


        var valData = [{
            "name": "Burundi",
            "value": 904924.5204
        }, {
            "name": "Central African Republic",
            "value": 1353094
        }, {
            "name": "Cameroon",
            "value": 0
        }, {
            "name": "Cabo Verde",
            "value": 396793.8862
        }, {
            "name": "Congo",
            "value": 0
        }, {
            "name": "Ivory Coast",
            "value": 13557.3485
        }, {
            "name": "Democratic Republic of the Congo",
            "value": 0
        }, {
            "name": "Djibouti",
            "value": 0
        }, {
            "name": "Eritrea",
            "value": 212517
        }, {
            "name": "Eswatini",
            "value": 0
        }, {
            "name": "Ethiopia",
            "value": 0
        }, {
            "name": "Gambia",
            "value": 186744.1116
        }, {
            "name": "Ghana",
            "value": 0
        }, {
            "name": "Guinea",
            "value": 0
        }, {
            "name": "Guinea Bissau",
            "value": 1427031
        }, {
            "name": "Kenya",
            "value": 0
        }, {
            "name": "Liberia",
            "value": 0
        }, {
            "name": "Madagascar",
            "value": 0
        }, {
            "name": "Malawi",
            "value": 0
        }, {
            "name": "Mozambique",
            "value": 0
        }, {
            "name": "Namibia",
            "value": 0
        }, {
            "name": "Niger",
            "value": 0
        }, {
            "name": "Nigeria",
            "value": 0
        }, {
            "name": "Rwanda",
            "value": 16368313.12
        }, {
            "name": "Senegal",
            "value": 0
        }, {
            "name": "Sierra Leone",
            "value": 0
        }, {
            "name": "Somalia",
            "value": 0
        }, {
            "name": "United Republic of Tanzania",
            "value": 4043320
        }, {
            "name": "Togo",
            "value": 0
        }, {
            "name": "Uganda",
            "value": 0
        }, {
            "name": "Zambia",
            "value": 2259659
        }, {
            "name": "Zimbabwe",
            "value": 1742602.175
        }, {
            "name": "Afghanistan",
            "value": 0
        }, {
            "name": "Bangladesh",
            "value": 3093161.705
        }, {
            "name": "Bhutan",
            "value": 93134
        }, {
            "name": "Cambodia",
            "value": 0
        }, {
            "name": "Honduras",
            "value": 0
        }, {
            "name": "India",
            "value": 0
        }, {
            "name": "Lao People's Democratic Republic",
            "value": 2444239
        }, {
            "name": "Myanmar",
            "value": 400380
        }, {
            "name": "Nepal",
            "value": 0
        }, {
            "name": "Pakistan",
            "value": 0
        }, {
            "name": "Papua New Guinea",
            "value": 19752220.58
        }, {
            "name": "Solomon Islands",
            "value": 459855
        }, {
            "name": "Thailand",
            "value": 0
        }, {
            "name": "Venezuela (Bolivarian Republic of)",
            "value": 0
        }, {
            "name": "Viet Nam",
            "value": 494744
        }, {
            "name": "Cambodia",
            "value": 0
        }, {
            "name": "Honduras",
            "value": 0
        }, {
            "name": "India",
            "value": 0
        }, {
            "name": "Lao People's Democratic Republic",
            "value": 2444239
        }, {
            "name": "Myanmar",
            "value": 400380
        }, {
            "name": "Nepal",
            "value": 0
        }, {
            "name": "Pakistan",
            "value": 0
        }, {
            "name": "Papua New Guinea",
            "value": 19752220.58
        }, {
            "name": "Solomon Islands",
            "value": 459855
        }, {
            "name": "Thailand",
            "value": 0
        }, {
            "name": "Venezuela (Bolivarian Republic of)",
            "value": 0
        }, {
            "name": "Viet Nam",
            "value": 494744
        }]
        var myData = _.keyBy(valData, 'name');
        //console.log(myData)
        var max = -Infinity;
        var min = Infinity;
        valData.forEach(function(itemOpt) {
            if (itemOpt.value > max) {
                max = itemOpt.value;
            }
            if (itemOpt.value < min) {
                min = itemOpt.value;
            }
        });
        console.log(min);
        console.log(max);
        console.log(_.mapValues(valData, 'value'));
        let allVal = valData;
       console.log(_.map(allVal,'value'));
            var myranget = chroma.limits(_.map(allVal,'value'), 'q', 10);
            console.log(myranget)
            var NN = _.compact(myranget).filter(function(x) {
                return x >= 0
            });
            var myrange = chroma.limits(NN, 'l', 13);
            let temp = {};
        //var myDiscretePieces = createDiscretePieces(_.mapValues(valData, 'value'), myRedScale);

        </script>

        </html>